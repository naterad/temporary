<!--///
/// MIKASO INC. ("COMPANY") CONFIDENTIAL
/// Unpublished Copyright (c) 2016 Mikaso, Inc., All Rights Reserved.
///
/// NOTICE:  All information contained herein is, and remains the property of COMPANY. The intellectual and technical concepts contained
/// herein are proprietary to COMPANY and may be covered by U.S. and Foreign Patents, patents in process, and are protected by trade secret or copyright law.
/// Dissemination of this information or reproduction of this material is strictly forbidden unless prior written permission is obtained
/// from COMPANY.  Access to the source code contained herein is hereby forbidden to anyone except current COMPANY employees, managers or contractors who have executed
/// Confidentiality and Non-disclosure agreements explicitly covering such access.
///
/// The copyright notice above does not evidence any actual or intended publication or disclosure of  this source code, which includes
/// information that is confidential and/or proprietary, and is a trade secret, of  COMPANY.   ANY REPRODUCTION, MODIFICATION, DISTRIBUTION, PUBLIC  PERFORMANCE,
/// OR PUBLIC DISPLAY OF OR THROUGH USE  OF THIS  SOURCE CODE  WITHOUT  THE EXPRESS WRITTEN CONSENT OF COMPANY IS STRICTLY PROHIBITED, AND IN VIOLATION OF APPLICABLE
/// LAWS AND INTERNATIONAL TREATIES.  THE RECEIPT OR POSSESSION OF  THIS SOURCE CODE AND/OR RELATED INFORMATION DOES NOT CONVEY OR IMPLY ANY RIGHTS
/// TO REPRODUCE, DISCLOSE OR DISTRIBUTE ITS CONTENTS, OR TO MANUFACTURE, USE, OR SELL ANYTHING THAT IT  MAY DESCRIBE, IN WHOLE OR IN PART.
///-->

<div class="page-login" id="page-top">
	<div class="wrapper">
		<header-comp></header-comp>

    <div *ngIf="inForm" class="form-container">
    <div class="container-container">
      <div class="progess-container">
        <table style="width:100%">

          <tr>
            <td *ngFor=" let section of form;  let i=index"  class="progress-section" (click)="jumpTo(i)">
              <div class="progress-line" [ngClass]="{'done2': i<=currentSection }"></div>
              <div class="progress-circle" [ngClass]="{'done2': i<=currentSection }"></div>
            </td>
            <td class="progress-section" (click)="jumpToSummary()">
              <div class="progress-line" [ngClass]="{'done2': i<=currentSection }"></div>
              <div class="progress-circle" [ngClass]="{'done2': i<=currentSection }"></div>
            </td>
          </tr>
          <tr>
            <td *ngFor=" let section of form;  let i=index"  class="progress-section"  (click)="jumpTo(i)">
              {{ section.Name }}
            </td>
            <td class="progress-section" (click)="jumpToSummary()">
              Summary
            </td>
          </tr>
        </table>
      </div>
    </div>
      <div class="card">
        <div *ngFor=" let section of form;  let i=index">
          <!-- {{section}} -->
          <div *ngFor=" let question of section.Questions;  let j=index">
            <div *ngIf="i==currentSection && j==currentQuestion" class="question-container row">

              <div class="col-sm-2 col-xs-2 side-button-container">
                <button *ngIf="!(currentSection == 0 && currentQuestion == 0)" type="submit" class="side-button glyphicon glyphicon-chevron-left" (click)="back()"></button>
                <!-- <button *ngIf="!(currentSection == 0 && currentQuestion == 0)" type="submit" class="btn btn-small btn-primary" (click)="back()">Back</button> -->
              </div>
              <div class="col-sm-8 col-xs-8 center-content">

                <div>
                  <div class="question-title">{{ question.Title }}</div>
                  <div class="question-description">{{ question.Description }}</div>
                  <div *ngIf="question.ErrorBool">{{ question.ErrorMessage }}</div>
                  <div *ngIf="question.Type=='Text'">
                    <input type="text" class="question-text" [placeholder]="question.Placeholder" [(ngModel)]="question.Value" (blur)="validateText(question.Value)" (focus)="question.ErrorBool=false">
                  </div>
                  <div *ngIf="question.Type=='TextBox'">
                    <textarea rows="3" class="question-textarea" [placeholder]="question.Placeholder" [(ngModel)]="question.Value" (blur)="validateText(question.Value)" (focus)="question.ErrorBool=false"></textarea>
                  </div>
                  <div *ngIf="question.Type=='Number'">
                    <input type="number" class="question-text" step=".01" [id]="question.ID" [placeholder]="question.Placeholder" [(ngModel)]="question.Value" (ngModelChange)="validateNumber(question.Value)">
                  </div>
                  <div *ngIf="question.Type=='Dropdown'">
                    <p-dropdown [options]="question.Options" [style]="{'width':'250px'}" [(ngModel)]="question.Value" (ngModelChange)="validateDropDown(question.Value)"></p-dropdown>
                  </div>
                  <div *ngIf="question.Type=='Date'">
                    <p-calendar [minDate]="currentDate" [(ngModel)]="question.Value"></p-calendar>
                  </div>
                  <div *ngIf="question.Type=='Boolean'">
                    <p-selectButton width="600" height="200"[options]="question.Options" [(ngModel)]="question.Value" (ngModelChange)="validateSelectButton(question.Value)"></p-selectButton>
                  </div>
                </div>


              </div>
              <div class="col-sm-2 col-xs-2 side-button-container">
                <!-- <button type="submit" class="btn btn-small btn-primary" (click)="next()" [disabled]="!(question.Value || (question.Type=='Number' && question.Value>-1))">Next</button> -->
                <button class="side-button glyphicon glyphicon-chevron-right" (click)="next()" [disabled]="!(question.Value || (question.Type=='Number' && question.Value>-1))"></button>
                <!-- <span class="glyphicon glyphicon-chevron-right" aria-hidden="true" (click)="next()" [disabled]="!(question.Value || (question.Type=='Number' && question.Value>-1))"></span> -->
              </div>


            </div>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="!inForm" class="container col-md-12">

      <div class="col-sm-2 col-xs-2"></div>
      <div class="col-sm-8 col-xs-8" style="background-color:white;">
				<h2 class="summary-title">Your Offer Summary</h2>
				<p class="summary-subtitle">Click on any question to take you back to the wizard</p>
				<br>
				<br>
				<div *ngFor=" let section of form;  let i=index">
          <div *ngFor=" let question of section.Questions;  let j=index" class="summary-row">
            <div class="row" [ngClass]="{'error': !(question['Is Completed']) }">
						    <div class="summary-cell col-sm-6 col-xs-6" (click)="jumpToQuestion(j,i)">{{ question.Title }}</div>
						    <div class="summary-cell col-sm-6 col-xs-6" (click)="jumpToQuestion(j,i)">{{ question.Value }}</div>
								<!-- <div *ngIf="">{{ question.Value['name'] }}</div> -->
            </div>
          </div>
        </div>
				<div class="center">
	        <button *ngIf="!(currentSection==0 && currentQuestion==0)" type="submit" class="btn btn-small btn-primary" (click)="back()">Back</button>
	        <button type="submit" class="btn btn-small btn-primary" [disabled]="!(completedQuestions==questionCount)" (click)="submitForm()">Submit</button>

					<br>
					<br>
					<br>
	      </div>
      </div>
      <div class="col-sm-2 col-xs-2"></div>
    </div>
    <p-dialog header="Offer Submitted" class="feedback-container" modal="modal" width="600" responsive="true" [(visible)]="offerSubmitted">
        <div style="height:211px;">Please check your email for next steps.</div>
        <footer>
              <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                  <button type="button" class="btn btn-primary" (click)="goToMyOffers()">Ok</button>
              </div>
        </footer>
    </p-dialog>
		<p-dialog header="We'd like your feedback" class="feedback-container" modal="modal" width="600" height="353" responsive="true" [(visible)]="displayFeedback">
      <div *ngIf="feedbackQuestion">
        <textarea rows="10" cols="78" class="feedback-textarea" placeholder=""></textarea>
        <footer>
              <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                  <button type="button" class="btn btn-primary" (click)="submitFeedback()">Submit</button>
                  <button type="button" class="btn btn-primary" (click)="displayFeedback=false">Cancel</button>
              </div>
        </footer>
      </div>
      <div *ngIf="feedbackResponse">
        <div style="height:211px;">Thank you for your feedback.</div>
        <footer>
          <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
            <button type="button" class="btn btn-primary" (click)="closeFeedback()">Ok</button>
          </div>
        </footer>
      </div>
    </p-dialog>
    <div class="feedback">
      <button type="submit" class="btn btn-small btn-primary" (click)="showDialog()">Feedback</button>
    </div>
	</div>
</div>
